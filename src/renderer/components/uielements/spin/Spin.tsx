import clsx from 'clsx'

type SpinProps = {
  className?: string
  spinning?: boolean
  tip?: string // optional status text
  children?: React.ReactNode
}

export const Spin = ({ className, spinning = true, tip, children }: SpinProps) => {
  if (!children) {
    return (
      <div className={clsx('flex flex-col items-center justify-center space-y-2', className)}>
        {spinning && (
          <>
            <svg
              className="animate-spin rounded-full border border-solid border-turquoise bg-turquoise fill-bg0 dark:fill-bg0d"
              width="40"
              height="40"
              viewBox="0 0 512.000000 512.000000"
              preserveAspectRatio="xMidYMid meet">
              <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="inherit" stroke="none">
                <path d="M2335 5109 c-513 -53 -952 -227 -1355 -537 -126 -97 -363 -340 -461 -472 -121 -163 -171 -244 -254 -415 -125 -256 -192 -471 -236 -756 -32 -205 -32 -533 0 -738 44 -285 111 -500 236 -756 131 -268 269 -460 489 -681 221 -220 413 -358 681 -489 256 -125 471 -192 756 -236 205 -32 533 -32 738 0 285 44 500 111 756 236 268 131 460 269 681 489 220 221 358 413 489 681 125 256 193 472 236 756 32 206 32 534 0 738 -44 285 -111 500 -236 756 -131 268 -269 460 -489 681 -221 220 -413 358 -681 489 -256 125 -475 193 -751 235 -160 24 -461 34 -599 19z m300 -1636 c281 -482 512 -880 513 -885 2 -4 -140 -8 -315 -8 l-319 0 -198 341 c-109 187 -200 338 -203 335 -3 -2 -92 -155 -198 -338 l-194 -333 -315 -3 c-174 -1 -316 1 -316 5 0 11 1022 1763 1029 1763 3 0 236 -395 516 -877z m1075 -626 c276 -483 501 -880 499 -882 -2 -2 -465 -7 -1028 -11 l-1024 -7 33 59 c19 32 91 158 161 279 l127 220 395 5 395 5 -185 320 c-101 176 -189 330 -195 342 -9 19 6 50 112 235 174 303 191 331 200 321 4 -4 234 -403 510 -886z m-1431 -3 c83 -144 151 -266 151 -272 0 -5 -85 -158 -190 -340 -104 -182 -190 -336 -190 -341 0 -8 124 -11 393 -11 l393 0 157 -271 c87 -150 156 -274 153 -276 -2 -3 -465 -1 -1029 3 l-1024 7 422 736 c232 405 461 805 509 889 49 85 92 150 96 145 5 -4 76 -126 159 -269z" />
              </g>
            </svg>
            {tip && <p className="text-sm text-text0 dark:text-text0d">{tip}</p>}
          </>
        )}
      </div>
    )
  }

  return (
    <div className={clsx('relative', className)}>
      {spinning && (
        <div className="absolute inset-0 z-50 flex flex-col items-center justify-center space-y-2">
          <svg
            className="animate-spin rounded-full border border-solid border-turquoise bg-turquoise fill-bg0 dark:fill-bg0d"
            width="40"
            height="40"
            viewBox="0 0 512.000000 512.000000"
            preserveAspectRatio="xMidYMid meet">
            <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="inherit" stroke="none">
              <path d="M2335 5109 c-513 -53 -952 -227 -1355 -537 -126 -97 -363 -340 -461 -472 -121 -163 -171 -244 -254 -415 -125 -256 -192 -471 -236 -756 -32 -205 -32 -533 0 -738 44 -285 111 -500 236 -756 131 -268 269 -460 489 -681 221 -220 413 -358 681 -489 256 -125 471 -192 756 -236 205 -32 533 -32 738 0 285 44 500 111 756 236 268 131 460 269 681 489 220 221 358 413 489 681 125 256 193 472 236 756 32 206 32 534 0 738 -44 285 -111 500 -236 756 -131 268 -269 460 -489 681 -221 220 -413 358 -681 489 -256 125 -475 193 -751 235 -160 24 -461 34 -599 19z m300 -1636 c281 -482 512 -880 513 -885 2 -4 -140 -8 -315 -8 l-319 0 -198 341 c-109 187 -200 338 -203 335 -3 -2 -92 -155 -198 -338 l-194 -333 -315 -3 c-174 -1 -316 1 -316 5 0 11 1022 1763 1029 1763 3 0 236 -395 516 -877z m1075 -626 c276 -483 501 -880 499 -882 -2 -2 -465 -7 -1028 -11 l-1024 -7 33 59 c19 32 91 158 161 279 l127 220 395 5 395 5 -185 320 c-101 176 -189 330 -195 342 -9 19 6 50 112 235 174 303 191 331 200 321 4 -4 234 -403 510 -886z m-1431 -3 c83 -144 151 -266 151 -272 0 -5 -85 -158 -190 -340 -104 -182 -190 -336 -190 -341 0 -8 124 -11 393 -11 l393 0 157 -271 c87 -150 156 -274 153 -276 -2 -3 -465 -1 -1029 3 l-1024 7 422 736 c232 405 461 805 509 889 49 85 92 150 96 145 5 -4 76 -126 159 -269z" />
            </g>
          </svg>
          {tip && <p className="text-sm text-text0 dark:text-text0d">{tip}</p>}
        </div>
      )}
      {children}
    </div>
  )
}
